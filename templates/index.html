{% extends 'base.html' %}

{% block content %}
<!-- Stats Dashboard -->
<div class="row mb-4">
    <div class="col-sm-3">
        <div class="card bg-light">
            <div class="card-body text-center">
                <h6 class="text-muted mb-2">Today's Shots</h6>
                <h3 class="mb-0">{{ today_shots_count }}</h3>
            </div>
        </div>
    </div>
    <div class="col-sm-3">
        <div class="card bg-light">
            <div class="card-body text-center">
                <h6 class="text-muted mb-2">Average Rating</h6>
                <h3 class="mb-0">{{ "%.1f"|format(avg_rating) }}</h3>
            </div>
        </div>
    </div>
    <div class="col-sm-3">
        <div class="card bg-light">
            <div class="card-body text-center">
                <h6 class="text-muted mb-2">Active Coffees</h6>
                <h3 class="mb-0">{{ active_coffees_count }}</h3>
            </div>
        </div>
    </div>
    <div class="col-sm-3">
        <div class="card bg-light">
            <div class="card-body text-center">
                <h6 class="text-muted mb-2">Total Shots</h6>
                <h3 class="mb-0">{{ total_shots_count }}</h3>
            </div>
        </div>
    </div>
</div>

<!-- Main Content -->
<div class="row">
    <div class="col-md-8">
        <!-- Shot submission form -->
        <div class="card shadow-sm p-4 mb-4">
            {% include 'partials/_shot_form.html' %}
        </div>
    </div>
    
    <div class="col-md-4">
        <!-- Add Coffee Quick Card -->
        <div class="card shadow-sm mb-4">
            <div class="card-body">
                <h5 class="card-title">
                    <i class="fas fa-coffee text-primary"></i> Quick Add Coffee
                </h5>
                <p class="text-muted small">Track a new coffee in your collection</p>
                <a href="{{ url_for('add_coffee') }}" class="btn btn-outline-primary btn-block">
                    <i class="fas fa-plus"></i> Add New Coffee
                </a>
            </div>
        </div>

        <!-- Quick Tips Card -->
        <div class="card shadow-sm mb-4">
            <div class="card-body">
                <h5 class="card-title">
                    <i class="fas fa-lightbulb text-warning"></i> Quick Tips
                </h5>
                <ul class="list-unstyled mb-0">
                    <li class="mb-2">
                        <i class="fas fa-check-circle text-success"></i> 
                        Ideal ratio: 1:2 (coffee:yield)
                    </li>
                    <li class="mb-2">
                        <i class="fas fa-clock text-info"></i> 
                        Target time: 25-30s
                    </li>
                    <li class="mb-2">
                        <i class="fas fa-thermometer-half text-danger"></i> 
                        Water temp: 90-96Â°C
                    </li>
                    <li>
                        <i class="fas fa-balance-scale text-primary"></i> 
                        Dose: 18-21g
                    </li>
                </ul>
            </div>
        </div>

        <!-- Last Shot Card -->
        {% if last_shot %}
        <div class="card shadow-sm">
            <div class="card-body">
                <h5 class="card-title">
                    <i class="fas fa-history text-info"></i> Last Shot
                </h5>
                <ul class="list-unstyled mb-0">
                    <li class="mb-2">
                        <small class="text-muted">Grind Size:</small><br>
                        {{ last_shot.grind_size }}
                    </li>
                    <li class="mb-2">
                        <small class="text-muted">Ratio:</small><br>
                        1:{{ "%.1f"|format(last_shot.shot_yield / last_shot.coffee_weight) }}
                    </li>
                    <li>
                        <small class="text-muted">Time:</small><br>
                        {{ last_shot.shot_time }}s
                    </li>
                </ul>
            </div>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}
